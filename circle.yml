machine:
  python:
    version: 2.7.9

dependencies:
  override:
    - pip install tox
test:
  override:
    - tox -e docs
    - tox -e flake8
    - tox -e py27
    - echo $CI_PULL_REQUEST
    - if [ $CI_PULL_REQUEST != "" ] then 
         git clone --depth=50 --branch=$CIRCLE_BRANCH  https://github.com/cloudify-cosmo/$CIRCLE_PROJECT_REPONAME.git cloudify-cosmo/$CIRCLE_PROJECT_REPONAME
         cd cloudify-cosmo/$CIRCLE_PROJECT_REPONAME
         git checkout -qf $CIRCLE_SHA1
      fi    
    - if [ $CI_PULL_REQUEST != "" ] then 
         tox -e docs
      fi 
    - if [ $CI_PULL_REQUEST != "" ] then
         tox -e flake8
      fi 
    - if [ $CI_PULL_REQUEST != "" ] then
         tox -e py27
      fi 

